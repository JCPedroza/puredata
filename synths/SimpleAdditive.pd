#N canvas 75 195 1170 504 10;
#X obj 334 372 dac~;
#N canvas 135 88 1121 654 harmonics 0;
#X obj 20 89 inlet freq;
#X obj 416 483 outlet~;
#N canvas 288 219 980 536 h01 1;
#X obj 172 295 osc~;
#X msg 380 125 1;
#X obj 33 202 *;
#X obj 350 174 expr 1/$f1;
#X floatatom 353 216 5 0 0 0 - - -;
#X obj 345 411 *~;
#N canvas 381 249 458 495 ADSR 0;
#X obj 77 142 pack f f f f;
#X msg 78 172 1 \$2 \, \$4 \$3 \$2;
#X obj 129 211 vline~;
#X obj 131 271 outlet~;
#X obj 123 61 inlet trigger;
#X obj -59 22 inlet a;
#X obj -11 23 inlet d;
#X obj 35 22 inlet s;
#X obj 83 22 inlet r;
#X obj 211 61 inlet velocity;
#X obj 212 103 sel 0;
#X obj 181 140 pack f f;
#X msg 180 173 0 \$2;
#X connect 0 0 1 0;
#X connect 1 0 2 0;
#X connect 2 0 3 0;
#X connect 4 0 0 0;
#X connect 5 0 0 1;
#X connect 6 0 0 2;
#X connect 7 0 0 3;
#X connect 8 0 11 1;
#X connect 9 0 10 0;
#X connect 10 0 11 0;
#X connect 11 0 12 0;
#X connect 12 0 2 0;
#X restore 511 234 pd ADSR;
#X obj 7 31 r freq;
#X obj 385 13 r trigger;
#X obj 481 17 r a;
#X obj 515 18 r d;
#X obj 548 18 r s;
#X obj 587 16 r r;
#X obj 304 355 *~;
#X obj 616 16 r env_offset;
#X obj 746 17 r velocity;
#X obj 336 460 throw~ harmonics_out;
#X obj 384 34 t b b b;
#X obj 476 182 +;
#X obj 508 182 +;
#X obj 575 184 +;
#X obj 590 90 random;
#X obj 105 204 osc~;
#X obj 158 239 *~;
#X obj 133 271 +~;
#X obj 51 4 r fm_freq;
#X obj 112 4 r fm_amt;
#X obj 266 102 osc~;
#X text 114 189 FM;
#X obj 258 11 r am_freq;
#X obj 320 11 r am_amt;
#X obj 222 345 *~;
#X text 277 85 AM;
#X text 304 337 ENV;
#X text 228 303 AM;
#X text 338 387 amp = 1/n;
#X text 138 254 FM;
#X obj 265 129 *~ 0.5;
#X obj 263 190 +~ 0.5;
#X obj 265 159 *~ 0;
#X text 344 108 harmonic number;
#X text 174 277 harmonic;
#X obj 168 6 r fm_offset;
#X obj 142 53 random;
#X obj 144 103 expr $f1-($f2/2);
#X obj 100 160 +;
#X obj 148 29 * 20;
#X obj 143 77 / 20;
#X floatatom 194 203 5 0 0 0 - - -;
#X obj 55 114 t b;
#X connect 0 0 31 0;
#X connect 1 0 3 0;
#X connect 1 0 2 1;
#X connect 2 0 24 0;
#X connect 3 0 4 0;
#X connect 4 0 5 1;
#X connect 5 0 16 0;
#X connect 6 0 13 1;
#X connect 7 0 2 0;
#X connect 8 0 17 0;
#X connect 9 0 18 1;
#X connect 10 0 19 1;
#X connect 11 0 6 2;
#X connect 12 0 20 1;
#X connect 13 0 5 0;
#X connect 14 0 21 1;
#X connect 15 0 6 5;
#X connect 17 0 1 0;
#X connect 17 1 6 4;
#X connect 17 2 21 0;
#X connect 17 2 43 0;
#X connect 18 0 6 0;
#X connect 19 0 6 1;
#X connect 20 0 6 3;
#X connect 21 0 18 0;
#X connect 21 0 19 0;
#X connect 21 0 20 0;
#X connect 22 0 23 0;
#X connect 23 0 24 1;
#X connect 24 0 0 0;
#X connect 25 0 45 1;
#X connect 25 0 49 0;
#X connect 26 0 23 1;
#X connect 27 0 37 0;
#X connect 29 0 27 0;
#X connect 30 0 39 1;
#X connect 31 0 13 0;
#X connect 37 0 39 0;
#X connect 38 0 31 1;
#X connect 39 0 38 0;
#X connect 42 0 44 1;
#X connect 42 0 46 0;
#X connect 42 0 49 0;
#X connect 43 0 47 0;
#X connect 44 0 45 0;
#X connect 45 0 22 0;
#X connect 45 0 48 0;
#X connect 46 0 43 1;
#X connect 47 0 44 0;
#X connect 49 0 45 0;
#X restore 391 273 pd h01;
#X obj 89 88 inlet trigger;
#X obj 176 89 inlet a;
#X obj 226 88 inlet d;
#X obj 275 88 inlet s;
#X obj 324 87 inlet r;
#X obj 21 117 s freq;
#X obj 88 116 s trigger;
#X obj 178 121 s a;
#X obj 225 119 s d;
#X obj 274 118 s s;
#X obj 324 117 s r;
#X obj 379 87 inlet env_offset;
#X obj 380 122 s env_offset;
#X text 364 16 For simplicity \, connections in this subpatch are made
through sends and receives. All sends go to the harmonic modules \,
and all harmonic modules send their audio output to harmonics_out.
;
#X obj 491 87 inlet velocity;
#X obj 491 118 s velocity;
#X obj 408 443 catch~ harmonics_out;
#X obj 604 88 inlet fm_freq;
#X obj 693 86 inlet fm_amt;
#X obj 603 119 s fm_freq;
#X obj 692 117 s fm_amt;
#X obj 942 91 inlet am_freq;
#X obj 942 123 s am_freq;
#X obj 1030 123 s am_amt;
#X obj 1032 91 inlet am_amt;
#X obj 773 86 inlet fm_offset;
#X obj 772 115 s fm_offset;
#X connect 0 0 8 0;
#X connect 3 0 9 0;
#X connect 4 0 10 0;
#X connect 5 0 11 0;
#X connect 6 0 12 0;
#X connect 7 0 13 0;
#X connect 14 0 15 0;
#X connect 17 0 18 0;
#X connect 19 0 1 0;
#X connect 20 0 22 0;
#X connect 21 0 23 0;
#X connect 24 0 25 0;
#X connect 27 0 26 0;
#X connect 28 0 29 0;
#X restore 304 216 pd harmonics;
#N canvas 416 320 450 300 amp 0;
#X obj 129 15 inlet~;
#X obj 187 256 outlet~;
#X obj 187 182 *~;
#X obj 287 26 inlet~ env;
#X obj 198 20 inlet volume;
#X obj 182 92 *~;
#X connect 0 0 5 0;
#X connect 2 0 1 0;
#X connect 3 0 2 1;
#X connect 4 0 5 1;
#X connect 5 0 2 0;
#X restore 331 320 pd amp;
#N canvas 372 220 458 495 ADSR 0;
#X obj 77 142 pack f f f f;
#X msg 78 172 1 \$2 \, \$4 \$3 \$2;
#X obj 129 211 vline~;
#X obj 131 271 outlet~;
#X obj 123 61 inlet trigger;
#X obj -59 22 inlet a;
#X obj -11 23 inlet d;
#X obj 35 22 inlet s;
#X obj 83 22 inlet r;
#X obj 211 61 inlet velocity;
#X obj 212 103 sel 0;
#X obj 181 140 pack f f;
#X msg 180 173 0 \$2;
#X obj 190 215 print;
#X connect 0 0 1 0;
#X connect 1 0 2 0;
#X connect 2 0 3 0;
#X connect 4 0 0 0;
#X connect 5 0 0 1;
#X connect 6 0 0 2;
#X connect 7 0 0 3;
#X connect 8 0 11 1;
#X connect 9 0 10 0;
#X connect 10 0 11 0;
#X connect 11 0 12 0;
#X connect 12 0 2 0;
#X restore 412 300 pd ADSR;
#X obj 561 -56 vsl 15 200 0 250 0 0 empty empty A 0 -9 0 10 -262144
-1 -1 3400 1;
#X obj 593 -54 vsl 15 200 5 1000 0 0 empty empty D 0 -9 0 10 -262144
-1 -1 5400 1;
#X obj 628 -57 vsl 15 200 0 1 0 0 empty empty S 0 -9 0 10 -262144 -1
-1 16800 1;
#X obj 657 -55 vsl 15 200 0 500 0 0 empty empty R 0 -9 0 10 -262144
-1 -1 10200 1;
#X floatatom 551 161 5 0 0 0 - - -;
#X floatatom 587 160 5 0 0 0 - - -;
#X floatatom 624 160 5 0 0 0 - - -;
#X floatatom 661 160 5 0 0 0 - - -;
#X text 590 -89 amp envelope;
#X obj 1114 -59 vsl 15 128 0 1 0 0 empty empty volume 0 -9 0 10 -262144
-1 -1 9900 1;
#X obj 697 -52 vsl 15 200 1 100 0 0 empty empty env_offset 0 -9 0 10
-262144 -1 -1 0 1;
#X floatatom 700 159 5 0 0 0 - - -;
#X obj 361 -12 notein;
#X obj 355 40 stripnote;
#X obj 356 77 mtof;
#X obj 316 145 t f b;
#X text 18 89 #TODO: implement random offset in sustain of harmonic
envelope;
#X obj 790 -60 vsl 15 200 0 20 0 0 empty empty FM_Freq 0 -9 0 10 -262144
-1 -1 0 1;
#X obj 840 -59 vsl 15 200 0 10 0 0 empty empty FM_Amt 0 -9 0 10 -262144
-1 -1 0 1;
#X floatatom 791 158 5 0 0 0 - - -;
#X floatatom 836 161 5 0 0 0 - - -;
#X obj 1004 -59 vsl 15 200 0 20 0 0 empty empty AM_Freq 0 -9 0 10 -262144
-1 -1 0 1;
#X obj 1063 -55 vsl 15 200 0 1 0 0 empty empty AM_Amt 0 -9 0 10 -262144
-1 -1 0 1;
#X floatatom 1007 160 5 0 0 0 - - -;
#X floatatom 1063 164 5 0 0 0 - - -;
#X text 72 43 Imlement harmonic panning;
#X obj 883 -56 vsl 15 200 0 20 0 0 empty empty FM_Offset 0 -9 0 10
-262144 -1 -1 0 1;
#X floatatom 881 159 5 0 0 0 - - -;
#X text 32 26 #TODO: tremolo needs random offset.;
#X connect 1 0 2 0;
#X connect 2 0 0 0;
#X connect 2 0 0 1;
#X connect 3 0 2 2;
#X connect 4 0 8 0;
#X connect 5 0 9 0;
#X connect 6 0 10 0;
#X connect 7 0 11 0;
#X connect 8 0 3 0;
#X connect 8 0 1 2;
#X connect 9 0 3 1;
#X connect 9 0 1 3;
#X connect 10 0 3 2;
#X connect 10 0 1 4;
#X connect 11 0 3 3;
#X connect 11 0 1 5;
#X connect 13 0 2 1;
#X connect 14 0 15 0;
#X connect 15 0 1 6;
#X connect 16 0 17 0;
#X connect 16 1 17 1;
#X connect 16 1 1 7;
#X connect 16 1 3 5;
#X connect 17 0 18 0;
#X connect 17 0 3 4;
#X connect 18 0 19 0;
#X connect 19 0 1 0;
#X connect 19 1 1 1;
#X connect 21 0 23 0;
#X connect 22 0 24 0;
#X connect 23 0 1 8;
#X connect 24 0 1 9;
#X connect 25 0 27 0;
#X connect 26 0 28 0;
#X connect 27 0 1 11;
#X connect 28 0 1 12;
#X connect 30 0 31 0;
#X connect 31 0 1 10;
