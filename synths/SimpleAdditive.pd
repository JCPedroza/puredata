#N canvas 68 135 1170 504 10;
#X obj 334 372 dac~;
#N canvas -26 93 1121 654 harmonics 1;
#X obj 20 89 inlet freq;
#N canvas 166 205 980 536 h01 1;
#X obj 172 295 osc~;
#X obj 33 202 *;
#X obj 350 174 expr 1/$f1;
#X obj 370 398 *~;
#N canvas 381 249 458 495 ADSR 0;
#X obj 77 142 pack f f f f;
#X msg 78 172 1 \$2 \, \$4 \$3 \$2;
#X obj 129 211 vline~;
#X obj 131 271 outlet~;
#X obj 123 61 inlet trigger;
#X obj -59 22 inlet a;
#X obj -11 23 inlet d;
#X obj 35 22 inlet s;
#X obj 83 22 inlet r;
#X obj 211 61 inlet velocity;
#X obj 212 103 sel 0;
#X obj 181 140 pack f f;
#X msg 180 173 0 \$2;
#X connect 0 0 1 0;
#X connect 1 0 2 0;
#X connect 2 0 3 0;
#X connect 4 0 0 0;
#X connect 5 0 0 1;
#X connect 6 0 0 2;
#X connect 7 0 0 3;
#X connect 8 0 11 1;
#X connect 9 0 10 0;
#X connect 10 0 11 0;
#X connect 11 0 12 0;
#X connect 12 0 2 0;
#X restore 511 234 pd ADSR;
#X obj 7 31 r freq;
#X obj 385 13 r trigger;
#X obj 481 17 r a;
#X obj 515 18 r d;
#X obj 548 18 r s;
#X obj 587 16 r r;
#X obj 304 355 *~;
#X obj 616 16 r env_offset;
#X obj 712 16 r velocity;
#X obj 384 34 t b b b;
#X obj 476 182 +;
#X obj 508 182 +;
#X obj 575 184 +;
#X obj 590 90 random;
#X obj 105 204 osc~;
#X obj 158 239 *~;
#X obj 133 271 +~;
#X obj 51 4 r fm_freq;
#X obj 112 4 r fm_amt;
#X obj 266 102 osc~;
#X text 114 189 FM;
#X obj 258 11 r am_freq;
#X obj 320 11 r am_amt;
#X obj 224 324 *~;
#X text 277 85 AM;
#X text 304 337 ENV;
#X text 228 303 AM;
#X text 363 374 amp = 1/n;
#X text 138 254 FM;
#X obj 263 190 +~ 0.5;
#X text 344 108 harmonic number;
#X text 174 277 harmonic;
#X obj 168 6 r fm_offset;
#X obj 142 53 random;
#X obj 144 103 expr $f1-($f2/2);
#X obj 100 160 +;
#X obj 148 29 * 20;
#X obj 143 77 / 20;
#X floatatom 194 203 5 0 0 0 - - -;
#X obj 55 114 t b;
#X obj 278 505 throw~ out_L;
#X obj 454 501 throw~ out_R;
#X obj 428 447 *~;
#X obj 324 445 *~;
#X obj 561 332 hsl 128 15 0 1 0 0 empty empty empty -2 -8 0 10 -262144
-1 -1 6350 1;
#X obj 450 365 expr 1 - $f1;
#X text 360 461 panning;
#X obj 794 17 r pan_amt;
#X obj 763 129 mod 2;
#X obj 775 187 +;
#X obj 752 220 moses 1.2;
#X obj 748 159 t b;
#X obj 782 256 - 1.5;
#X obj 879 530;
#X obj 771 283 expr 0.5 - $f1;
#X floatatom 353 216 5 0 0 0 - - -;
#X msg 380 125 1;
#X text 735 311 odd harmonics pan to the left \, pair harmonics pan
to the right;
#N canvas 763 354 450 300 smoother 0;
#X obj 194 81 inlet;
#X obj 197 165 outlet~;
#X obj 196 110 pack 0 50;
#X obj 196 137 line~;
#X connect 0 0 2 0;
#X connect 2 0 3 0;
#X connect 3 0 1 0;
#X restore 501 406 pd smoother;
#N canvas 763 354 450 300 smoother 0;
#X obj 194 81 inlet;
#X obj 197 165 outlet~;
#X obj 196 110 pack 0 50;
#X obj 196 137 line~;
#X connect 0 0 2 0;
#X connect 2 0 3 0;
#X connect 3 0 1 0;
#X restore 425 407 pd smoother;
#X obj 265 129 *~ 0.5;
#N canvas 763 354 450 300 smoother 0;
#X obj 194 81 inlet;
#X obj 197 165 outlet~;
#X obj 196 110 pack 0 50;
#X obj 196 137 line~;
#X connect 0 0 2 0;
#X connect 2 0 3 0;
#X connect 3 0 1 0;
#X restore 310 65 pd smoother;
#X obj 265 159 *~;
#X connect 0 0 28 0;
#X connect 1 0 21 0;
#X connect 2 0 60 0;
#X connect 3 0 48 0;
#X connect 3 0 47 0;
#X connect 4 0 11 1;
#X connect 5 0 1 0;
#X connect 6 0 14 0;
#X connect 7 0 15 1;
#X connect 8 0 16 1;
#X connect 9 0 4 2;
#X connect 10 0 17 1;
#X connect 11 0 3 0;
#X connect 12 0 18 1;
#X connect 13 0 4 5;
#X connect 14 0 61 0;
#X connect 14 1 4 4;
#X connect 14 2 18 0;
#X connect 14 2 38 0;
#X connect 15 0 4 0;
#X connect 16 0 4 1;
#X connect 17 0 4 3;
#X connect 18 0 15 0;
#X connect 18 0 16 0;
#X connect 18 0 17 0;
#X connect 19 0 20 0;
#X connect 20 0 21 1;
#X connect 21 0 0 0;
#X connect 22 0 40 1;
#X connect 22 0 44 0;
#X connect 23 0 20 1;
#X connect 24 0 65 0;
#X connect 26 0 24 0;
#X connect 27 0 66 0;
#X connect 28 0 11 0;
#X connect 34 0 28 1;
#X connect 37 0 39 1;
#X connect 37 0 41 0;
#X connect 37 0 44 0;
#X connect 38 0 42 0;
#X connect 39 0 40 0;
#X connect 40 0 19 0;
#X connect 40 0 43 0;
#X connect 41 0 38 1;
#X connect 42 0 39 0;
#X connect 44 0 40 0;
#X connect 47 0 46 0;
#X connect 48 0 45 0;
#X connect 49 0 50 0;
#X connect 49 0 63 0;
#X connect 50 0 64 0;
#X connect 52 0 54 0;
#X connect 53 0 54 1;
#X connect 53 0 56 0;
#X connect 54 0 55 0;
#X connect 55 0 49 0;
#X connect 55 1 57 0;
#X connect 56 0 54 0;
#X connect 57 0 59 0;
#X connect 59 0 49 0;
#X connect 60 0 3 1;
#X connect 61 0 2 0;
#X connect 61 0 1 1;
#X connect 61 0 53 0;
#X connect 63 0 47 1;
#X connect 64 0 48 1;
#X connect 65 0 67 0;
#X connect 66 0 67 1;
#X connect 67 0 34 0;
#X restore 410 274 pd h01;
#X obj 89 88 inlet trigger;
#X obj 176 89 inlet a;
#X obj 226 88 inlet d;
#X obj 275 88 inlet s;
#X obj 324 87 inlet r;
#X obj 21 117 s freq;
#X obj 88 116 s trigger;
#X obj 178 121 s a;
#X obj 225 119 s d;
#X obj 274 118 s s;
#X obj 324 117 s r;
#X obj 379 87 inlet env_offset;
#X obj 380 122 s env_offset;
#X text 364 16 For simplicity \, connections in this subpatch are made
through sends and receives. All sends go to the harmonic modules \,
and all harmonic modules send their audio output to harmonics_out.
;
#X obj 491 87 inlet velocity;
#X obj 491 118 s velocity;
#X obj 585 87 inlet fm_freq;
#X obj 674 85 inlet fm_amt;
#X obj 584 118 s fm_freq;
#X obj 673 116 s fm_amt;
#X obj 857 85 inlet am_freq;
#X obj 857 117 s am_freq;
#X obj 945 117 s am_amt;
#X obj 947 85 inlet am_amt;
#X obj 754 85 inlet fm_offset;
#X obj 753 114 s fm_offset;
#X obj 378 436 catch~ out_L;
#X obj 477 441 catch~ out_R;
#X obj 379 495 outlet~ L;
#X obj 468 496 outlet~ R;
#X obj 1029 86 inlet pan_amt;
#X obj 1028 114 s pan_amt;
#X connect 0 0 7 0;
#X connect 2 0 8 0;
#X connect 3 0 9 0;
#X connect 4 0 10 0;
#X connect 5 0 11 0;
#X connect 6 0 12 0;
#X connect 13 0 14 0;
#X connect 16 0 17 0;
#X connect 18 0 20 0;
#X connect 19 0 21 0;
#X connect 22 0 23 0;
#X connect 25 0 24 0;
#X connect 26 0 27 0;
#X connect 28 0 30 0;
#X connect 29 0 31 0;
#X connect 32 0 33 0;
#X restore 299 250 pd harmonics;
#N canvas 468 216 648 477 amp 0;
#X obj 201 266 *~;
#X obj 287 26 inlet~ env;
#X obj 198 20 inlet volume;
#X obj 172 180 *~;
#X obj 55 13 inlet~ L;
#X obj 124 15 inlet~ R;
#X obj 213 180 *~;
#X obj 239 265 *~;
#X obj 162 352 outlet~ L;
#X obj 227 353 outlet~ R;
#N canvas 763 354 450 300 smoother 0;
#X obj 194 81 inlet;
#X obj 197 165 outlet~;
#X obj 196 110 pack 0 50;
#X obj 196 137 line~;
#X connect 0 0 2 0;
#X connect 2 0 3 0;
#X connect 3 0 1 0;
#X restore 198 78 pd smoother;
#X connect 0 0 8 0;
#X connect 1 0 0 1;
#X connect 1 0 7 1;
#X connect 2 0 10 0;
#X connect 3 0 0 0;
#X connect 4 0 3 0;
#X connect 5 0 6 0;
#X connect 6 0 7 0;
#X connect 7 0 9 0;
#X connect 10 0 3 1;
#X connect 10 0 6 1;
#X restore 331 320 pd amp;
#N canvas 372 220 458 495 ADSR 0;
#X obj 77 142 pack f f f f;
#X msg 78 172 1 \$2 \, \$4 \$3 \$2;
#X obj 129 211 vline~;
#X obj 131 271 outlet~;
#X obj 123 61 inlet trigger;
#X obj -59 22 inlet a;
#X obj -11 23 inlet d;
#X obj 35 22 inlet s;
#X obj 83 22 inlet r;
#X obj 211 61 inlet velocity;
#X obj 212 103 sel 0;
#X obj 181 140 pack f f;
#X msg 180 173 0 \$2;
#X obj 190 215 print;
#X connect 0 0 1 0;
#X connect 1 0 2 0;
#X connect 2 0 3 0;
#X connect 4 0 0 0;
#X connect 5 0 0 1;
#X connect 6 0 0 2;
#X connect 7 0 0 3;
#X connect 8 0 11 1;
#X connect 9 0 10 0;
#X connect 10 0 11 0;
#X connect 11 0 12 0;
#X connect 12 0 2 0;
#X restore 412 300 pd ADSR;
#X obj 493 -35 vsl 15 200 0 250 0 0 empty empty A 0 -9 0 10 -262144
-1 -1 3800 1;
#X obj 525 -33 vsl 15 200 5 1000 0 0 empty empty D 0 -9 0 10 -262144
-1 -1 7200 1;
#X obj 560 -36 vsl 15 200 0 1 0 0 empty empty S 0 -9 0 10 -262144 -1
-1 13600 1;
#X obj 589 -34 vsl 15 200 0 500 0 0 empty empty R 0 -9 0 10 -262144
-1 -1 19200 1;
#X floatatom 483 182 5 0 0 0 - - -;
#X floatatom 519 181 5 0 0 0 - - -;
#X floatatom 556 181 5 0 0 0 - - -;
#X floatatom 593 181 5 0 0 0 - - -;
#X text 522 -68 amp envelope;
#X obj 1093 -29 vsl 15 128 0 1 0 0 empty empty volume 0 -9 0 10 -262144
-1 -1 10700 1;
#X obj 629 -31 vsl 15 200 1 100 0 0 empty empty env_offset 0 -9 0 10
-262144 -1 -1 0 1;
#X floatatom 632 180 5 0 0 0 - - -;
#X obj 361 -12 notein;
#X obj 355 40 stripnote;
#X obj 356 77 mtof;
#X obj 316 145 t f b;
#X text 18 89 #TODO: implement random offset in sustain of harmonic
envelope;
#X obj 711 -40 vsl 15 200 0 20 0 0 empty empty FM_Freq 0 -9 0 10 -262144
-1 -1 0 1;
#X obj 761 -39 vsl 15 200 0 10 0 0 empty empty FM_Amt 0 -9 0 10 -262144
-1 -1 0 1;
#X floatatom 712 178 5 0 0 0 - - -;
#X floatatom 757 181 5 0 0 0 - - -;
#X obj 880 -41 vsl 15 200 0 20 0 0 empty empty AM_Freq 0 -9 0 10 -262144
-1 -1 16400 1;
#X obj 938 -39 vsl 15 200 0 1 0 0 empty empty AM_Amt 0 -9 0 10 -262144
-1 -1 0 1;
#X floatatom 883 178 5 0 0 0 - - -;
#X floatatom 939 182 5 0 0 0 - - -;
#X obj 804 -36 vsl 15 200 0 20 0 0 empty empty FM_Offset 0 -9 0 10
-262144 -1 -1 0 1;
#X floatatom 802 179 5 0 0 0 - - -;
#X text 32 26 #TODO: tremolo needs random offset.;
#X obj 1007 -41 vsl 15 200 0.5 1 0 0 empty empty stereo_width 0 -9
0 10 -262144 -1 -1 0 1;
#X floatatom 1005 183 5 0 0 0 - - -;
#X connect 1 0 2 0;
#X connect 1 1 2 1;
#X connect 2 0 0 0;
#X connect 2 1 0 1;
#X connect 3 0 2 3;
#X connect 4 0 8 0;
#X connect 5 0 9 0;
#X connect 6 0 10 0;
#X connect 7 0 11 0;
#X connect 8 0 3 0;
#X connect 8 0 1 2;
#X connect 9 0 3 1;
#X connect 9 0 1 3;
#X connect 10 0 3 2;
#X connect 10 0 1 4;
#X connect 11 0 3 3;
#X connect 11 0 1 5;
#X connect 13 0 2 2;
#X connect 14 0 15 0;
#X connect 15 0 1 6;
#X connect 16 0 17 0;
#X connect 16 1 17 1;
#X connect 16 1 1 7;
#X connect 16 1 3 5;
#X connect 17 0 18 0;
#X connect 17 0 3 4;
#X connect 18 0 19 0;
#X connect 19 0 1 0;
#X connect 19 1 1 1;
#X connect 21 0 23 0;
#X connect 22 0 24 0;
#X connect 23 0 1 8;
#X connect 24 0 1 9;
#X connect 25 0 27 0;
#X connect 26 0 28 0;
#X connect 27 0 1 11;
#X connect 28 0 1 12;
#X connect 29 0 30 0;
#X connect 30 0 1 10;
#X connect 32 0 33 0;
#X connect 33 0 1 13;
