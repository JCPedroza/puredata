#N canvas 57 22 1170 504 10;
#X obj 466 365 dac~;
#N canvas 135 88 1121 654 harmonics 0;
#X obj 179 95 inlet freq;
#X obj 416 483 outlet~;
#N canvas 316 104 862 502 h01 1;
#X obj 181 219 osc~;
#X msg 205 86 1;
#X obj 182 154 *;
#X floatatom 183 191 5 0 0 0 - - -;
#X obj 224 154 expr 1/$f1;
#X floatatom 230 190 5 0 0 0 - - -;
#X obj 213 258 *~;
#N canvas 381 249 458 495 ADSR 0;
#X obj 77 142 pack f f f f;
#X msg 78 172 1 \$2 \, \$4 \$3 \$2;
#X obj 129 211 vline~;
#X obj 131 271 outlet~;
#X obj 123 61 inlet trigger;
#X obj -59 22 inlet a;
#X obj -11 23 inlet d;
#X obj 35 22 inlet s;
#X obj 83 22 inlet r;
#X obj 211 61 inlet velocity;
#X obj 212 103 sel 0;
#X obj 181 140 pack f f;
#X msg 180 173 0 \$2;
#X connect 0 0 1 0;
#X connect 1 0 2 0;
#X connect 2 0 3 0;
#X connect 4 0 0 0;
#X connect 5 0 0 1;
#X connect 6 0 0 2;
#X connect 7 0 0 3;
#X connect 8 0 11 1;
#X connect 9 0 10 0;
#X connect 10 0 11 0;
#X connect 11 0 12 0;
#X connect 12 0 2 0;
#X restore 382 282 pd ADSR;
#X obj 78 13 r freq;
#X obj 206 12 r trigger;
#X obj 368 12 r a;
#X obj 395 13 r d;
#X obj 423 14 r s;
#X obj 450 13 r r;
#X obj 235 294 *~;
#X obj 529 11 r env_offset;
#X obj 385 176 *;
#X obj 412 177 *;
#X obj 441 176 *;
#X obj 469 175 *;
#X obj 490 76 expr $f1 / 90;
#X floatatom 446 321 5 0 0 0 - - -;
#X floatatom 490 322 5 0 0 0 - - -;
#X floatatom 530 325 5 0 0 0 - - -;
#X floatatom 577 324 5 0 0 0 - - -;
#X text 447 348 BUG: ves los valores que sonarán en el siguiente trigger
\, no los que sonaron en el actual;
#X text 122 408 TODO: mejora implementacion del env offset;
#X obj 627 10 r velocity;
#X obj 266 378 throw~ harmonics_out;
#X obj 499 39 random;
#X obj 210 49 t b b;
#X connect 0 0 6 0;
#X connect 1 0 2 1;
#X connect 1 0 4 0;
#X connect 2 0 3 0;
#X connect 3 0 0 0;
#X connect 4 0 5 0;
#X connect 5 0 6 1;
#X connect 6 0 14 0;
#X connect 7 0 14 1;
#X connect 8 0 2 0;
#X connect 9 0 29 0;
#X connect 9 0 30 0;
#X connect 10 0 16 1;
#X connect 11 0 17 1;
#X connect 12 0 18 1;
#X connect 13 0 19 1;
#X connect 14 0 28 0;
#X connect 15 0 29 1;
#X connect 16 0 21 0;
#X connect 16 0 7 0;
#X connect 17 0 22 0;
#X connect 17 0 7 1;
#X connect 18 0 23 0;
#X connect 18 0 7 2;
#X connect 19 0 7 3;
#X connect 19 0 24 0;
#X connect 20 0 16 0;
#X connect 20 0 17 0;
#X connect 20 0 18 0;
#X connect 20 0 19 0;
#X connect 27 0 7 5;
#X connect 29 0 20 0;
#X connect 30 0 1 0;
#X connect 30 1 7 4;
#X restore 391 273 pd h01;
#X obj 331 97 inlet trigger;
#X obj 634 93 inlet a;
#X obj 684 92 inlet d;
#X obj 733 92 inlet s;
#X obj 782 91 inlet r;
#X obj 180 123 s freq;
#X obj 331 123 s trigger;
#X obj 636 125 s a;
#X obj 683 123 s d;
#X obj 732 122 s s;
#X obj 782 121 s r;
#X obj 837 91 inlet env_offset;
#X obj 838 126 s env_offset;
#X text 364 16 For simplicity \, connections in this subpatch are made
through sends and receives. All sends go to the harmonic modules \,
and all harmonic modules send their audio output to harmonics_out.
;
#X obj 949 91 inlet velocity;
#X obj 949 122 s velocity;
#X obj 408 443 catch~ harmonics_out;
#X connect 0 0 8 0;
#X connect 3 0 9 0;
#X connect 4 0 10 0;
#X connect 5 0 11 0;
#X connect 6 0 12 0;
#X connect 7 0 13 0;
#X connect 14 0 15 0;
#X connect 17 0 18 0;
#X connect 19 0 1 0;
#X restore 425 266 pd harmonics;
#N canvas 416 320 450 300 amp 0;
#X obj 129 15 inlet~;
#X obj 187 256 outlet~;
#X obj 187 182 *~;
#X obj 287 26 inlet~ env;
#X obj 198 20 inlet volume;
#X obj 182 92 *~;
#X connect 0 0 5 0;
#X connect 2 0 1 0;
#X connect 3 0 2 1;
#X connect 4 0 5 1;
#X connect 5 0 2 0;
#X restore 463 313 pd amp;
#N canvas 456 206 458 495 ADSR 0;
#X obj 77 142 pack f f f f;
#X msg 78 172 1 \$2 \, \$4 \$3 \$2;
#X obj 129 211 vline~;
#X obj 131 271 outlet~;
#X obj 123 61 inlet trigger;
#X obj -59 22 inlet a;
#X obj -11 23 inlet d;
#X obj 35 22 inlet s;
#X obj 83 22 inlet r;
#X obj 211 61 inlet velocity;
#X obj 212 103 sel 0;
#X obj 181 140 pack f f;
#X msg 180 173 0 \$2;
#X obj 190 215 print;
#X connect 0 0 1 0;
#X connect 1 0 2 0;
#X connect 2 0 3 0;
#X connect 4 0 0 0;
#X connect 5 0 0 1;
#X connect 6 0 0 2;
#X connect 7 0 0 3;
#X connect 8 0 11 1;
#X connect 9 0 10 0;
#X connect 10 0 11 0;
#X connect 11 0 12 0;
#X connect 12 0 2 0;
#X restore 544 293 pd ADSR;
#X obj 825 -2 vsl 15 128 0 250 0 0 empty empty A 0 -9 0 10 -262144
-1 -1 900 1;
#X obj 862 -3 vsl 15 128 5 1000 0 0 empty empty D 0 -9 0 10 -262144
-1 -1 800 1;
#X obj 897 -6 vsl 15 128 0 1 0 0 empty empty S 0 -9 0 10 -262144 -1
-1 12200 1;
#X obj 926 -4 vsl 15 128 0 500 0 0 empty empty R 0 -9 0 10 -262144
-1 -1 2400 1;
#X floatatom 818 146 5 0 0 0 - - -;
#X floatatom 854 145 5 0 0 0 - - -;
#X floatatom 891 145 5 0 0 0 - - -;
#X floatatom 928 145 5 0 0 0 - - -;
#X text 859 -38 amp envelope;
#X obj 749 -3 vsl 15 128 0 1 0 0 empty empty volume 0 -9 0 10 -262144
-1 -1 10100 1;
#X obj 988 -4 vsl 15 128 1 100 0 0 empty empty env_offset 0 -9 0 10
-262144 -1 -1 300 1;
#X floatatom 987 144 5 0 0 0 - - -;
#X text 750 251 BUG: en offset 1 el env del harmonico se va a 0 en
todos los stages \, en lugar de eso tiene que ser idéntico al amp
envelopope general;
#X text 74 29 #TODO: harmonic tremolo and vibrato and pan;
#X obj 493 -19 notein;
#X obj 487 33 stripnote;
#X obj 488 70 mtof;
#X obj 448 138 t f b;
#X connect 1 0 2 0;
#X connect 2 0 0 0;
#X connect 2 0 0 1;
#X connect 3 0 2 2;
#X connect 4 0 8 0;
#X connect 5 0 9 0;
#X connect 6 0 10 0;
#X connect 7 0 11 0;
#X connect 8 0 3 0;
#X connect 8 0 1 2;
#X connect 9 0 3 1;
#X connect 9 0 1 3;
#X connect 10 0 3 2;
#X connect 10 0 1 4;
#X connect 11 0 3 3;
#X connect 11 0 1 5;
#X connect 13 0 2 1;
#X connect 14 0 15 0;
#X connect 15 0 1 6;
#X connect 18 0 19 0;
#X connect 18 1 19 1;
#X connect 18 1 1 7;
#X connect 18 1 3 5;
#X connect 19 0 20 0;
#X connect 19 0 3 4;
#X connect 20 0 21 0;
#X connect 21 0 1 0;
#X connect 21 1 1 1;
